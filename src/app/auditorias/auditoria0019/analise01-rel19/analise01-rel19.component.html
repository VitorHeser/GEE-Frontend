<div class="ui-g-12">
  <div class="ui-g-12">
    <div class="ui-g-12" style="text-align: left; margin-top: -40px;">
      <h1>
        Análise Quantitativa - {{valor}}
      </h1>
    </div>
    <div class="ui-g-12" style="text-align: left; margin-top: -40px;">
      <h3>
        Lista de unidades que apresentaram algum valor 0 depois de ter alguma medição, durante o período {{ data1 + " - "+data2 }} 
      </h3>
    </div>
    <div class="ui-g-12" style="text-align: right;">
        <button type="button" pButton icon="pi pi-file-excel" label="Extrair CSV" (click)="extraircsv()" class="ui-button-success"></button>
    </div>
  </div>

  <p-table #dt class="ui-g-12" [style]="{height:'1000px'}" [columns]="Cols" 
    [frozenColumns]="ColsFrozen" [value]="dadosAnalisados2" [scrollable]="true"
    [paginator]="true" [rows]="100" frozenWidth="250px">
    <ng-template pTemplate="frozencolgroup" let-columns>
        <colgroup>
            <col style="width:250px">
        </colgroup>
    </ng-template>
    <ng-template pTemplate="colgroup" let-columns>
        <colgroup>
            <col *ngFor="let col of columns" style="width: 150px;">
        </colgroup>
    </ng-template>
    <ng-template pTemplate="header" let-columns>
      <tr>
        <th *ngFor="let col of columns" [pSortableColumn]="col.field" 
        style="width: '50px'; text-align: center">
          {{col.header}}
          <p-sortIcon [field]="col.field" ariaLabel="Activate to sort" ariaLabelDesc="Activate to sort in descending order" ariaLabelAsc="Activate to sort in ascending order"></p-sortIcon>
        </th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-rowData let-columns="columns">
        <tr>
            <td *ngFor="let col of columns, let i=index" style="font-size:10px !important; text-align: center;" 
            [ngClass]="rowData[col.field]==0 ? 'zerados' : null">
                {{  rowData[col.field].toLocaleString(undefined, {minimumFractionDigits: 2,maximumFractionDigits: 2})}}
            </td>
        </tr>
    </ng-template>
  </p-table>
</div>
